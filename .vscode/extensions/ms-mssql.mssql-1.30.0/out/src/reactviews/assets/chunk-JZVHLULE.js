import{b as je}from"./chunk-URDRCMFG.js";import{b as N,e as Se}from"./chunk-LO5WMIDP.js";import{$a as Ie,Ab as Ke,Ba as R,Fa as ve,Ga as me,Ha as _e,Ja as ce,Nb as a,Oa as Ge,Pb as ze,Ra as Be,U as Me,a as e,ab as V,c as E,ca as ye,d as oe,db as Ce,fa as Ae,ia as ge,ja as Ue,k as _,ka as $e,lb as Ee,ma as Re,mb as Xe,na as re,qb as Pe,r as $,tb as Oe,x as D,ya as he,yb as ke,zb as Fe}from"./chunk-Z2VFB3HA.js";var Ze=e((X1,Is)=>{Is.exports="./iterator_catch_all-ERWJ4TKQ.png"});var We=e((O1,xs)=>{xs.exports="./cursor_catch_all-IZGG25RF.png"});var Je=e((k1,fs)=>{fs.exports="./language_construct_catch_all-34GKH7RY.png"});var et=e((F1,Hs)=>{Hs.exports="./adaptive_join-NJ4RYBAF.png"});var tt=e((K1,bs)=>{bs.exports="./assert-F76BAEMW.png"});var nt=e((z1,Cs)=>{Cs.exports="./bitmap-HRDVRE7D.png"});var ot=e((S1,Es)=>{Es.exports="./clustered_index_delete-SHVCIHTS.png"});var st=e((j1,Ps)=>{Ps.exports="./clustered_index_insert-I5DMI62Y.png"});var it=e((Q1,Ns)=>{Ns.exports="./clustered_index_scan-UAQ45DS7.png"});var at=e((Y1,ws)=>{ws.exports="./clustered_index_seek-Q63TGCHL.png"});var lt=e((Z1,Ds)=>{Ds.exports="./clustered_index_update-WPRR5C65.png"});var rt=e((W1,Vs)=>{Vs.exports="./clustered_index_merge-GAA5BKJC.png"});var ct=e((J1,qs)=>{qs.exports="./clustered_update-3URP5MAP.png"});var pt=e((ec,Ls)=>{Ls.exports="./collapse-222XNRVN.png"});var dt=e((tc,Ts)=>{Ts.exports="./compute_scalar-QGWH2F7N.png"});var ut=e((nc,Ms)=>{Ms.exports="./concatenation-LJETAGVC.png"});var ht=e((oc,ys)=>{ys.exports="./constant_scan-3Z2K7PKC.png"});var vt=e((sc,As)=>{As.exports="./deleted_scan-ZOQELBCZ.png"});var gt=e((ic,Us)=>{Us.exports="./filter-YAVMORQJ.png"});var mt=e((ac,$s)=>{$s.exports="./hash_match-P3XXEF77.png"});var It=e((lc,Rs)=>{Rs.exports="./index_delete-SOZQA37U.png"});var xt=e((rc,_s)=>{_s.exports="./index_insert-FI7IDKMG.png"});var ft=e((cc,Gs)=>{Gs.exports="./index_scan-LDHAH57C.png"});var Ht=e((pc,Bs)=>{Bs.exports="./columnstore_index_delete-CHSXCNML.png"});var bt=e((dc,Xs)=>{Xs.exports="./columnstore_index_insert-4ZJKHTTU.png"});var Ct=e((uc,Os)=>{Os.exports="./columnstore_index_merge-YY2ZOM6S.png"});var Et=e((hc,ks)=>{ks.exports="./columnstore_index_scan-3OIALZFQ.png"});var Pt=e((vc,Fs)=>{Fs.exports="./columnstore_index_update-QQ2WOHSL.png"});var Nt=e((gc,Ks)=>{Ks.exports="./index_seek-GYBTCDR6.png"});var wt=e((mc,zs)=>{zs.exports="./index_spool-JIH5L5YY.png"});var Dt=e((Ic,Ss)=>{Ss.exports="./index_update-ID2XFNEO.png"});var Vt=e((xc,js)=>{js.exports="./inserted_scan-CLZQEZXH.png"});var qt=e((fc,Qs)=>{Qs.exports="./log_row_scan-NLGHCSED.png"});var Lt=e((Hc,Ys)=>{Ys.exports="./merge_interval-OUKEWQPE.png"});var Tt=e((bc,Zs)=>{Zs.exports="./merge_join-HHXLGNFF.png"});var Mt=e((Cc,Ws)=>{Ws.exports="./nested_loops-OELDJ4XH.png"});var yt=e((Ec,Js)=>{Js.exports="./parallelism-FTWIPLE3.png"});var At=e((Pc,ei)=>{ei.exports="./parameter_table_scan-Z7WPW64X.png"});var Ut=e((Nc,ti)=>{ti.exports="./print-QI2CMPGB.png"});var $t=e((wc,ni)=>{ni.exports="./rank-TRZTIPB3.png"});var Rt=e((Dc,oi)=>{oi.exports="./foreign_key_references_check-NOV5KLEX.png"});var _t=e((Vc,si)=>{si.exports="./remote_delete-ULGTFQ76.png"});var Gt=e((qc,ii)=>{ii.exports="./remote_index_scan-KTS3FLLQ.png"});var Bt=e((Lc,ai)=>{ai.exports="./remote_index_seek-MSERQX4N.png"});var Xt=e((Tc,li)=>{li.exports="./remote_insert-HEI4E6TP.png"});var Ot=e((Mc,ri)=>{ri.exports="./remote_query-WYCBXFZ4.png"});var kt=e((yc,ci)=>{ci.exports="./remote_scan-BDZFERF6.png"});var Ft=e((Ac,pi)=>{pi.exports="./remote_update-6TBQSHBB.png"});var Kt=e((Uc,di)=>{di.exports="./rid_lookup-D5FBMWHM.png"});var zt=e(($c,ui)=>{ui.exports="./row_count_spool-4KN26Q7B.png"});var St=e((Rc,hi)=>{hi.exports="./segment-BUU7TVMK.png"});var jt=e((_c,vi)=>{vi.exports="./sequence-63YNEP2F.png"});var Qt=e((Gc,gi)=>{gi.exports="./sequence_project-H5L5LWBV.png"});var Yt=e((Bc,mi)=>{mi.exports="./sort-GU7TO3A4.png"});var Zt=e((Xc,Ii)=>{Ii.exports="./split-3EBXIJIT.png"});var Wt=e((Oc,xi)=>{xi.exports="./stream_aggregate-C5XTQCEI.png"});var Jt=e((kc,fi)=>{fi.exports="./switch-H5TF2B3A.png"});var en=e((Fc,Hi)=>{Hi.exports="./table_valued_function-5QRGBVDX.png"});var tn=e((Kc,bi)=>{bi.exports="./table_delete-ALEHGPOL.png"});var nn=e((zc,Ci)=>{Ci.exports="./table_insert-3CJFC3YM.png"});var on=e((Sc,Ei)=>{Ei.exports="./table_scan-BBK6MNRB.png"});var Ne=e((jc,Pi)=>{Pi.exports="./table_spool-NT54ZY3M.png"});var sn=e((Qc,Ni)=>{Ni.exports="./table_update-KXNJLZIE.png"});var an=e((Yc,wi)=>{wi.exports="./table_merge-75BLSF4P.png"});var ln=e((Zc,Di)=>{Di.exports="./predict-LIYCVLEE.png"});var rn=e((Wc,Vi)=>{Vi.exports="./top-LMKXZ2X7.png"});var cn=e((Jc,qi)=>{qi.exports="./udx-XTYTJKVA.png"});var pn=e((e0,Li)=>{Li.exports="./batch_hash_table_build-AEXVLVTT.png"});var dn=e((t0,Ti)=>{Ti.exports="./window_aggregate-BDTPNQVZ.png"});var un=e((n0,Mi)=>{Mi.exports="./fetch_query-VECOF2UX.png"});var we=e((o0,yi)=>{yi.exports="./population_query-MGSDO5UW.png"});var hn=e((s0,Ai)=>{Ai.exports="./refresh_query-SUSE7SEB.png"});var vn=e((i0,Ui)=>{Ui.exports="./result-ORS7BXSB.png"});var gn=e((a0,$i)=>{$i.exports="./aggregate-LXDYFXSJ.png"});var mn=e((l0,Ri)=>{Ri.exports="./assign-PVVR7CBL.png"});var In=e((r0,_i)=>{_i.exports="./arithmetic_expression-T5JH56CW.png"});var De=e((c0,Gi)=>{Gi.exports="./bookmark_lookup-MKMJZS5J.png"});var xn=e((p0,Bi)=>{Bi.exports="./convert-ZEUZDFTF.png"});var fn=e((d0,Xi)=>{Xi.exports="./declare-II63QGAS.png"});var Hn=e((u0,Oi)=>{Oi.exports="./delete-7PS3MUL4.png"});var bn=e((h0,ki)=>{ki.exports="./dynamic-VLTNNATU.png"});var Cn=e((v0,Fi)=>{Fi.exports="./hash_match_root-MCPPP7D6.png"});var En=e((g0,Ki)=>{Ki.exports="./hash_match_team-O7TRIL73.png"});var Pn=e((m0,zi)=>{zi.exports="./if-GQX3ZKRI.png"});var Nn=e((I0,Si)=>{Si.exports="./insert-6C27CLV3.png"});var Ve=e((x0,ji)=>{ji.exports="./intrinsic-TZT3TUH4.png"});var wn=e((f0,Qi)=>{Qi.exports="./keyset-TIXGDQFU.png"});var Dn=e((H0,Yi)=>{Yi.exports="./locate-SIDNYQTP.png"});var Vn=e((b0,Zi)=>{Zi.exports="./set_function-OX2J6H37.png"});var qn=e((C0,Wi)=>{Wi.exports="./snapshot-7AYGJ6UP.png"});var Ln=e((E0,Ji)=>{Ji.exports="./spool-V3GERV7N.png"});var Tn=e((P0,ea)=>{ea.exports="./sql-4UJQ6YMD.png"});var Mn=e((N0,ta)=>{ta.exports="./update-MRRTN7IG.png"});var qe=e((w0,na)=>{na.exports="./apply-YZCFVYOF.png"});var yn=e((D0,oa)=>{oa.exports="./broadcast-EURTTULC.png"});var An=e((V0,sa)=>{sa.exports="./compute_to_control_node-WDTJ52TB.png"});var Un=e((q0,ia)=>{ia.exports="./const_table_get-3SE2JJJN.png"});var $n=e((L0,aa)=>{aa.exports="./control_to_compute_nodes-TGX4MKE4.png"});var Rn=e((T0,la)=>{la.exports="./external_broadcast-UKHCXFTV.png"});var _n=e((M0,ra)=>{ra.exports="./external_export-2YCM2JWW.png"});var Gn=e((y0,ca)=>{ca.exports="./external_local_streaming-KRPGDKVL.png"});var Bn=e((A0,pa)=>{pa.exports="./external_round_robin-LF26GOBK.png"});var Xn=e((U0,da)=>{da.exports="./external_shuffle-HRZ75PQZ.png"});var On=e(($0,ua)=>{ua.exports="./get-GXG5EZV2.png"});var kn=e((R0,ha)=>{ha.exports="./group_by_aggregate-SI7Y6XDM.png"});var Fn=e((_0,va)=>{va.exports="./join-X56MOX2P.png"});var Kn=e((G0,ga)=>{ga.exports="./project-VNVXJWD6.png"});var zn=e((B0,ma)=>{ma.exports="./shuffle-7IKLYHGW.png"});var Sn=e((X0,Ia)=>{Ia.exports="./single_source_round_robin-XPBUQ4U5.png"});var jn=e((O0,xa)=>{xa.exports="./single_source_shuffle-AAXUYQAB.png"});var Qn=e((k0,fa)=>{fa.exports="./trim-HM4UGQXC.png"});var Yn=e((F0,Ha)=>{Ha.exports="./union-CRKBMMPV.png"});var Zn=e((K0,ba)=>{ba.exports="./union_all-E76RZLLJ.png"});var Wn=e((z0,Ca)=>{Ca.exports="./overlay-warning-EZOIYZMJ.svg"});var Jn=e((S0,Ea)=>{Ea.exports="./badge_critical_warning-QXUYYXF5.svg"});var eo=e((j0,Pa)=>{Pa.exports="./overlay-parallelism-OBWJKKME.svg"});var to=e((Q0,Na)=>{Na.exports="./expand_light-WKVFRGYD.svg"});var no=e((Y0,wa)=>{wa.exports="./expand_dark-E4M6RKF3.svg"});var oo=e((Z0,Da)=>{Da.exports="./collapse_light-K2A5XXHZ.svg"});var so=e((W0,Va)=>{Va.exports="./collapse_dark-5SDUUQEQ.svg"});var io=e((J0,qa)=>{qa.exports="./saveDark-ODSTFYRT.svg"});var ao=e((ep,La)=>{La.exports="./save-KQZXXAKN.svg"});var lo=e((tp,Ta)=>{Ta.exports="./openPlanFileDark-MFXQOGCI.svg"});var ro=e((np,Ma)=>{Ma.exports="./openPlanFile-6QM7HAVQ.svg"});var co=e((op,ya)=>{ya.exports="./openQueryDark-OJATIYNN.svg"});var po=e((sp,Aa)=>{Aa.exports="./openQuery-TWWN3OF2.svg"});var uo=e((ip,Ua)=>{Ua.exports="./zoomInDark-YB6JMTCB.svg"});var ho=e((ap,$a)=>{$a.exports="./zoomIn-5IE6WUN4.svg"});var vo=e((lp,Ra)=>{Ra.exports="./zoomOutDark-4RCYBQNI.svg"});var go=e((rp,_a)=>{_a.exports="./zoomOut-LXASSGEK.svg"});var mo=e((cp,Ga)=>{Ga.exports="./zoomToFitDark-UADNSWD2.svg"});var Io=e((pp,Ba)=>{Ba.exports="./zoomToFit-2PD3SCET.svg"});var xo=e((dp,Xa)=>{Xa.exports="./customZoomDark-QF3J4HEV.svg"});var fo=e((up,Oa)=>{Oa.exports="./customZoom-6BLRRTNF.svg"});var Ho=e((hp,ka)=>{ka.exports="./searchDark-IYZ23LVL.svg"});var bo=e((vp,Fa)=>{Fa.exports="./search-NKQS4MQU.svg"});var Co=e((gp,Ka)=>{Ka.exports="./openPropertiesDark-UQQIRGG3.svg"});var Eo=e((mp,za)=>{za.exports="./openProperties-V5GL6XOM.svg"});var Po=e((Ip,Sa)=>{Sa.exports="./highlightExpensiveOperationDark-IRHT7AJN.svg"});var No=e((xp,ja)=>{ja.exports="./highlightExpensiveOperation-GPAMRXSI.svg"});var wo=e((fp,Qa)=>{Qa.exports="./enableTooltipDark-BGQRYPS4.svg"});var Do=e((Hp,Ya)=>{Ya.exports="./enableTooltip-V6E2QA7T.svg"});var Vo=e((bp,Za)=>{Za.exports="./disableTooltipDark-V5ZCHS3G.svg"});var qo=e((Cp,Wa)=>{Wa.exports="./disableTooltip-HB74A7WG.svg"});var Lo=e((Ep,Ja)=>{Ja.exports="./sortByDisplayOrderDark-JKEUCROY.svg"});var To=e((Pp,el)=>{el.exports="./sortByDisplayOrder-OMBDGIM4.svg"});var Mo=e((Np,tl)=>{tl.exports="./sortAlphabeticallyDark-4X2IWUCQ.svg"});var yo=e((wp,nl)=>{nl.exports="./sortAlphabetically-YNQBJ2YQ.svg"});var Ao=e((Dp,ol)=>{ol.exports="./sortReverseAlphabeticallyDark-6KBUQAIR.svg"});var Uo=e((Vp,sl)=>{sl.exports="./sortReverseAlphabetically-MQIBG4MV.svg"});var $o=e((qp,il)=>{il.exports="./filterDark-RJWBNWPB.svg"});var Ro=e((Lp,al)=>{al.exports="./filter-4E3DG3T2.svg"});var _o=e((Tp,ll)=>{ll.exports="./expandAllDark-JFIZWG45.svg"});var Go=e((Mp,rl)=>{rl.exports="./expandAll-KVMM3K4O.svg"});var Bo=e((yp,cl)=>{cl.exports="./collapseAllDark-5LE2TTH6.svg"});var Xo=e((Ap,pl)=>{pl.exports="./collapseAll-3DXASXWQ.svg"});var Qe=E(oe());var Ye=E($()),j=(0,Qe.createContext)(void 0),R1=({children:o})=>{let t=ze();return(0,Ye.jsx)(j.Provider,{value:{...Se(t),getExecutionPlan:function(){t?.extensionRpc.action("getExecutionPlan",{})},saveExecutionPlan:function(n){t?.extensionRpc.action("saveExecutionPlan",{sqlPlanContent:n})},showPlanXml:function(n){t?.extensionRpc.action("showPlanXml",{sqlPlanContent:n})},showQuery:function(n){t?.extensionRpc.action("showQuery",{query:n})},updateTotalCost:function(n){t?.extensionRpc.action("updateTotalCost",{addedCost:n})},state:t?.state,themeKind:t?.themeKind},children:o})};var be=E(oe());var dl=Ze(),ul=We(),hl=Je(),vl=et(),gl=tt(),ml=nt(),Il=ot(),xl=st(),fl=it(),Hl=at(),bl=lt(),Cl=rt(),El=ct(),Pl=pt(),Nl=dt(),wl=ut(),Dl=ht(),Vl=vt(),ql=gt(),Ll=mt(),Tl=It(),Ml=xt(),yl=ft(),Al=Ht(),Ul=bt(),$l=Ct(),Rl=Et(),_l=Pt(),Gl=Nt(),Bl=wt(),Xl=Dt(),Ol=Vt(),kl=qt(),Fl=Lt(),Kl=Tt(),zl=Mt(),Sl=yt(),jl=At(),Ql=Ut(),Yl=$t(),Zl=Rt(),Wl=_t(),Jl=Gt(),er=Bt(),tr=Xt(),nr=Ot(),or=kt(),sr=Ft(),ir=Kt(),ar=zt(),lr=St(),rr=jt(),cr=Qt(),pr=Yt(),dr=Zt(),ur=Wt(),hr=Jt(),vr=en(),gr=tn(),mr=nn(),Ir=on(),xr=Ne(),fr=sn(),Hr=an(),br=ln(),Cr=rn(),Er=cn(),Pr=pn(),Nr=Ne(),wr=dn(),Dr=un(),Vr=we(),qr=hn(),Lr=vn(),Tr=gn(),Mr=mn(),yr=In(),Ar=De(),Ur=xn(),$r=fn(),Rr=Hn(),_r=bn(),Gr=Cn(),Br=En(),Xr=Pn(),Or=Nn(),kr=Ve(),Fr=wn(),Kr=Dn(),zr=we(),Sr=Vn(),jr=qn(),Qr=Ln(),Yr=Tn(),Zr=Mn(),Wr=De(),Jr=qe(),e1=yn(),t1=An(),n1=Un(),o1=$n(),s1=Rn(),i1=_n(),a1=Gn(),l1=Bn(),r1=Xn(),c1=On(),p1=qe(),d1=kn(),u1=Fn(),h1=Ve(),v1=Kn(),g1=zn(),m1=Sn(),I1=jn(),x1=Qn(),f1=Yn(),H1=Zn(),b1=Wn(),C1=Jn(),E1=eo();function Oo(){return{iteratorCatchAll:dl,cursorCatchAll:ul,languageConstructCatchAll:hl,adaptiveJoin:vl,assert:gl,bitmap:ml,clusteredIndexDelete:Il,clusteredIndexInsert:xl,clusteredIndexScan:fl,clusteredIndexSeek:Hl,clusteredIndexUpdate:bl,clusteredIndexMerge:Cl,clusteredUpdate:El,collapse:Pl,computeScalar:Nl,concatenation:wl,constantScan:Dl,deletedScan:Vl,filter:ql,hashMatch:Ll,indexDelete:Tl,indexInsert:Ml,indexScan:yl,columnstoreIndexDelete:Al,columnstoreIndexInsert:Ul,columnstoreIndexMerge:$l,columnstoreIndexScan:Rl,columnstoreIndexUpdate:_l,indexSeek:Gl,indexSpool:Bl,indexUpdate:Xl,insertedScan:Ol,logRowScan:kl,mergeInterval:Fl,mergeJoin:Kl,nestedLoops:zl,parallelism:Sl,parameterTableScan:jl,print:Ql,rank:Yl,foreignKeyReferencesCheck:Zl,remoteDelete:Wl,remoteIndexScan:Jl,remoteIndexSeek:er,remoteInsert:tr,remoteQuery:nr,remoteScan:or,remoteUpdate:sr,ridLookup:ir,rowCountSpool:ar,segment:lr,sequence:rr,sequenceProject:cr,sort:pr,split:dr,streamAggregate:ur,switchStatement:hr,tableValuedFunction:vr,tableDelete:gr,tableInsert:mr,tableScan:Ir,tableSpool:xr,tableUpdate:fr,tableMerge:Hr,tfp:br,top:Cr,udx:Er,batchHashTableBuild:Pr,windowSpool:Nr,windowAggregate:wr,fetchQuery:Dr,populateQuery:Vr,refreshQuery:qr,result:Lr,aggregate:Tr,assign:Mr,arithmeticExpression:yr,bookmarkLookup:Ar,convert:Ur,declare:$r,deleteOperator:Rr,dynamic:_r,hashMatchRoot:Gr,hashMatchTeam:Br,ifOperator:Xr,insert:Or,intrinsic:kr,keyset:Fr,locate:Kr,populationQuery:zr,setFunction:Sr,snapshot:jr,spool:Qr,tsql:Yr,update:Zr,keyLookup:Wr,apply:Jr,broadcast:e1,computeToControlNode:t1,constTableGet:n1,controlToComputeNodes:o1,externalBroadcast:s1,externalExport:i1,externalLocalStreaming:a1,externalRoundRobin:l1,externalShuffle:r1,get:c1,groupByApply:p1,groupByAggregate:d1,join:u1,localCube:h1,project:v1,shuffle:g1,singleSourceRoundRobin:m1,singleSourceShuffle:I1,trim:x1,union:f1,unionAll:H1}}function ko(){return{warning:b1,criticalWarning:C1,parallelism:E1}}function Fo(o){let t=N(o);return{expand:t==="light"?to():no(),collapse:t==="light"?oo():so()}}var Ko=o=>N(o)==="dark"?io():ao(),zo=o=>N(o)==="dark"?lo():ro(),So=o=>N(o)==="dark"?co():po(),jo=o=>N(o)==="dark"?uo():ho(),Qo=o=>N(o)==="dark"?vo():go(),Yo=o=>N(o)==="dark"?mo():Io(),Zo=o=>N(o)==="dark"?xo():fo(),Wo=o=>N(o)==="dark"?Ho():bo(),Jo=o=>N(o)==="dark"?Co():Eo(),es=o=>N(o)==="dark"?Po():No(),ts=o=>N(o)==="dark"?wo():Do(),ns=o=>N(o)==="dark"?Vo():qo(),os=o=>N(o)==="dark"?Lo():To(),ss=o=>N(o)==="dark"?Mo():yo(),is=o=>N(o)==="dark"?Ao():Uo(),as=o=>N(o)==="dark"?$o():Ro(),ls=o=>N(o)==="dark"?_o():Go(),rs=o=>N(o)==="dark"?Bo():Xo();var w=E(oe());var fe=class{_diagram;expensiveMetricTypes=new Set;_graphElementPropertiesSet=new Set;_executionPlanRootNode;constructor(t){this._executionPlanRootNode=t}getRoot(){return this._executionPlanRootNode}getTotalRelativeCost(){return this._executionPlanRootNode.cost+this._executionPlanRootNode.subTreeCost}getDiagram(){return this._diagram}setDiagram(t){this._diagram=t}populate(t=this._executionPlanRootNode){let n={};n.label=t.subtext.join(`
`),n.tooltipTitle=t.name,n.rowCountDisplayString=t.rowCountDisplayString,n.costDisplayString=t.costDisplayString,this.expensiveMetricTypes.add("off"),t.id.toString().startsWith("element-")||(t.id=`element-${t.id}`),n.id=t.id,n.icon=t.type,n.metrics=this.populateProperties(t.properties),n.badges=[];for(let s=0;t.badges&&s<t.badges.length;s++)n.badges.push(this.getBadgeTypeString(t.badges[s].type));n.edges=this.populateEdges(t.edges),n.children=[];for(let s=0;t.children&&s<t.children.length;++s)n.children.push(this.populate(t.children[s]));n.description=t.description,n.cost=t.cost,t.cost&&this.expensiveMetricTypes.add("cost"),n.subTreeCost=t.subTreeCost,t.subTreeCost&&this.expensiveMetricTypes.add("subtreeCost"),n.relativeCost=t.relativeCost,n.elapsedTimeInMs=t.elapsedTimeInMs,t.elapsedTimeInMs&&this.expensiveMetricTypes.add("actualElapsedTime");let i=[];for(let s=0;t.costMetrics&&s<t.costMetrics.length;++s)i.push(t.costMetrics[s]),this.loadMetricTypesFromCostMetrics(t.costMetrics[s].name);return n.costMetrics=i,n}loadMetricTypesFromCostMetrics(t){t==="ElapsedCpuTime"?this.expensiveMetricTypes.add("actualElapsedCpuTime"):t==="EstimateRowsAllExecs"||t==="ActualRows"?this.expensiveMetricTypes.add("actualNumberOfRowsForAllExecutions"):(t==="EstimatedRowsRead"||t==="ActualRowsRead")&&this.expensiveMetricTypes.add("numberOfRowsRead")}getBadgeTypeString(t){switch(t){case 0:return{type:"warning",tooltip:""};case 1:return{type:"criticalWarning",tooltip:""};case 2:return{type:"parallelism",tooltip:""};default:return}}populateProperties(t){return t?(t.forEach(n=>{this._graphElementPropertiesSet.add(n.name)}),t.filter(n=>typeof n.displayValue=="string"&&n.showInTooltip).sort((n,i)=>n.displayOrder-i.displayOrder).map(n=>({name:n.name,value:n.displayValue,isLongString:n.positionAtBottom}))):[]}populateEdges(t){return t?t.map(n=>(n.id=this.createGraphElementId(),{id:n.id,metrics:this.populateProperties(n.properties),weight:Math.max(.5,Math.min(.5+.75*Math.log10(n.rowCount),6)),label:""})):[]}createGraphElementId(){return`element-${window.crypto.randomUUID()}`}getUniqueElementProperties(){return[...this._graphElementPropertiesSet].sort()}toggleTooltip(){return this._diagram.showTooltip(!this._diagram.graph.showTooltip),this._diagram.graph.showTooltip}drawSubtreePolygon(t,n,i){let s=this._diagram.graph.model.getCell(`element-${t}`);this._diagram.drawPolygon(s,n,i)}clearSubtreePolygon(){this._diagram.removeDrawnPolygons()}disableNodeCollapse(t){this._diagram.disableNodeCollapse(t)}getSelectedElement(){let t=this._diagram.graph.getSelectionCell();if(t?.id)return this.getElementById(t.id)}zoomIn(){this._diagram.zoomIn()}zoomOut(){this._diagram.zoomOut()}zoomToFit(){this._diagram.zoomToFit(),this.getZoomLevel()>200&&this.setZoomLevel(200)}getZoomLevel(){return this._diagram.graph.view.getScale()*100}setZoomLevel(t){if(t<1)throw new Error("Zoom level cannot be 0 or negative");this._diagram.zoomTo(t)}searchNodes(t){let n=[],i=[];for(i.push(this._executionPlanRootNode);i.length!==0;){let s=i.pop(),l=s.properties.find(d=>d.name===t.propertyName),p=!1;if(typeof l?.value=="string"){switch(t.searchType){case 0:p=l.value===t.value;break;case 1:p=l.value.includes(t.value);break;case 3:p=l.value>t.value;break;case 2:p=l.value<t.value;break;case 4:p=l.value>=t.value;break;case 5:p=l.value<=t.value;break;case 6:p=l.value<t.value||l.value>t.value;break}p&&n.push(s)}i.push(...s.children)}return n}centerElement(t){if(!t)return;let n=this._diagram.graph.model.getCell(t.id);if(!n)return;let i=this._diagram.graph.getCellBounds(n),s={x:i.x+i.width/2,y:i.y+i.height/2},l=this._diagram.graph.container,p=l.getBoundingClientRect(),d={x:s.x-p.width/2,y:s.y-p.height/2};d.x=d.x<0?0:d.x,d.y=d.y<0?0:d.y,l.scrollTo({left:d.x,top:d.y,behavior:"smooth"})}selectElement(t,n=!1){let i;t?i=this._diagram.graph.model.getCell(t.id):i=this._diagram.graph.model.getCell(this._executionPlanRootNode.id),this._diagram.graph.getSelectionModel().setCell(i),n&&this.centerElement(t)}clearExpensiveOperatorHighlighting(){this._diagram.clearExpensiveOperatorHighlighting()}highlightExpensiveOperator(t){return this._diagram.highlightExpensiveOperator(t)}getElementById(t){let n=[];for(n.push(this._executionPlanRootNode);n.length!==0;){let i=n.pop();if(i.id===t)return i;if(i.edges){for(let s=0;s<i.edges.length;s++)if(i.edges[s].id===t)return i.edges[s]}n.push(...i.children)}}calculateRelativeQueryCost(){return this._executionPlanRootNode.subTreeCost+this._executionPlanRootNode.cost}};var pe=E(oe()),q=E($()),w1=_({inputContainer:{position:"absolute",top:0,right:"35px",padding:"10px",border:"1px solid #ccc",zIndex:"1",boxShadow:"0px 4px 6px rgba(0, 0, 0, 0.1)",display:"flex",alignItems:"center",gap:"2px",opacity:1},inputs:{minWidth:"unset",maxWidth:"unset"},option:{fontSize:"12px",whiteSpace:"nowrap",textAlign:"left",marginLeft:"0px",paddingLeft:"0px"},spacer:{padding:"1px"}}),cs=({executionPlanView:o,setExecutionPlanView:t,findNodeOptions:n,setFindNodeClicked:i})=>{let s=w1(),l=[a.executionPlan.equals,a.executionPlan.contains,">","<",">=","<=","<>"],p=[0,1,3,2,4,5,6],[d,h]=(0,pe.useState)(n[0]),[r,g]=(0,pe.useState)(l[0]),[v,m]=(0,pe.useState)(""),[P,A]=(0,pe.useState)([]),[L,T]=(0,pe.useState)(-1),U=async b=>{let M=[],X=0;if(o){let O=p[l.indexOf(r)];if(L===-1&&o){let B={propertyName:d,value:v,searchType:O};M=o.searchNodes(B),A(M),T(0)}else b===-1&&L===0?T(P.length-1):b===1&&L===P.length-1?T(0):T(L+b);P.length?o.selectElement(P[L],!0):o.selectElement(M[X],!0),t(o)}};return(0,q.jsxs)("div",{id:"findNodeInputContainer",className:s.inputContainer,style:{background:D.colorNeutralBackground1},children:[a.executionPlan.findNodes,(0,q.jsx)("div",{style:{paddingRight:"12px"}}),(0,q.jsx)(me,{id:"findNodeDropdown",className:s.inputs,size:"small",input:{style:{width:"130px",textOverflow:"ellipsis"}},listbox:{style:{minWidth:"fit-content"}},defaultValue:n[0],onOptionSelect:(b,M)=>{h(M.optionText??n[0]),T(-1),A([])},children:n.map(b=>(0,q.jsx)(ve,{className:s.option,children:b},b))}),(0,q.jsx)("div",{className:s.spacer}),(0,q.jsx)(_e,{id:"findNodeComparisonDropdown",size:"small",className:s.inputs,style:{width:"80px",textOverflow:"ellipsis",height:"24px"},defaultValue:l[0],onOptionSelect:(b,M)=>{g(M.optionText??l[0]),T(-1),A([])},children:l.map(b=>(0,q.jsx)(ve,{className:s.option,children:b},b))}),(0,q.jsx)("div",{className:s.spacer}),(0,q.jsx)(ce,{id:"findNodeInputBox",size:"small",type:"text",className:s.inputs,input:{style:{width:"85px",textOverflow:"ellipsis"}},onChange:b=>{m(b.target.value),T(-1),A([])}}),(0,q.jsx)("div",{className:s.spacer}),(0,q.jsx)(R,{onClick:()=>U(-1),size:"small",appearance:"subtle",title:a.executionPlan.previous,"aria-label":a.executionPlan.previous,icon:(0,q.jsx)(Ae,{})}),(0,q.jsx)(R,{onClick:()=>U(1),size:"small",appearance:"subtle",title:a.executionPlan.next,"aria-label":a.executionPlan.next,icon:(0,q.jsx)(ye,{})}),(0,q.jsx)(R,{onClick:()=>i(!1),size:"small",appearance:"subtle",title:a.common.close,"aria-label":a.common.close,icon:(0,q.jsx)(re,{})})]})};var ps=E(oe()),G=E($()),D1=_({inputContainer:{position:"absolute",top:0,right:"35px",padding:"10px",border:"1px solid #ccc",zIndex:"1",boxShadow:"0px 4px 6px rgba(0, 0, 0, 0.1)",display:"flex",alignItems:"center",gap:"2px",opacity:1},dropdown:{maxHeight:"200px"},spacer:{padding:"1px"}}),ds=({executionPlanView:o,setExecutionPlanView:t,setHighlightOpsClicked:n})=>{let i=D1(),[s,l]=(0,ps.useState)(""),p=[a.executionPlan.actualElapsedTime,a.executionPlan.actualElapsedCpuTime,a.executionPlan.cost,a.executionPlan.subtreeCost,a.executionPlan.actualNumberOfRowsForAllExecutions,a.executionPlan.numberOfRowsRead,a.executionPlan.off],d=["actualElapsedTime","actualElapsedCpuTime","cost","subtreeCost","actualNumberOfRowsForAllExecutions","numberOfRowsRead","off"],h=async()=>{if(o){let g=d[p.indexOf(s)],v=V1(g);o.clearExpensiveOperatorHighlighting();let m=o.highlightExpensiveOperator(v);m&&o.centerElement(o.getElementById(m)),t(o)}},r=async()=>{o&&(o.clearExpensiveOperatorHighlighting(),t(o)),n(!1)};return(0,G.jsxs)("div",{id:"highlightExpensiveOpsContainer",className:i.inputContainer,style:{background:D.colorNeutralBackground1},children:[(0,G.jsx)("div",{children:a.executionPlan.metric}),(0,G.jsx)("div",{style:{paddingRight:"12px"}}),(0,G.jsx)(me,{id:"highlightExpensiveOpsDropdown",size:"small",input:{style:{textOverflow:"ellipsis"}},listbox:{style:{minWidth:"fit-content"}},onOptionSelect:(g,v)=>l(v.optionText??""),children:p.map(g=>(0,G.jsx)(ve,{children:g},g))}),(0,G.jsx)("div",{className:i.spacer}),(0,G.jsx)(R,{onClick:h,size:"small",appearance:"subtle",title:a.common.apply,"aria-label":a.common.apply,icon:(0,G.jsx)(ge,{})}),(0,G.jsx)(R,{icon:(0,G.jsx)(re,{}),size:"small",appearance:"subtle",title:a.common.close,"aria-label":a.common.close,onClick:r})]})};function V1(o){let t=h=>h.elapsedTimeInMs,n=h=>{let r=h.costMetrics.find(g=>g.name==="ElapsedCpuTime");if(r!==void 0)return Number(r.value)},i=h=>h.cost,s=h=>h.subTreeCost,l=h=>{let r=h.costMetrics.find(m=>m.name==="ActualRows"),g=h.costMetrics.find(m=>m.name==="EstimateRowsAllExecs");if(r===void 0&&g===void 0)return;let v=Number(r?.value);if(v||(v=Number(g?.value)),!isNaN(v))return v},p=h=>{let r=h.costMetrics.find(m=>m.name==="ActualRowsRead"),g=h.costMetrics.find(m=>m.name==="EstimatedRowsRead");if(r===void 0&&g===void 0)return;let v=Number(r?.value);if(v||(v=Number(g?.value)),!isNaN(v))return v},d=i;switch(o){case"actualElapsedTime":d=t;break;case"actualElapsedCpuTime":d=n;break;case"subtreeCost":d=s;break;case"actualNumberOfRowsForAllExecutions":d=l;break;case"numberOfRowsRead":d=p;break}return d}var He=E(oe());var x=E($()),q1=_({iconStack:{right:0,display:"flex",flexDirection:"column",alignItems:"center",width:"25px",opacity:1,zIndex:"1",position:"absolute",height:"100%"},button:{cursor:"pointer"},buttonImg:{display:"block",height:"16px",width:"16px"},seperator:{width:"100%",height:"2px",border:"none"}}),us=({executionPlanView:o,setExecutionPlanView:t,setZoomNumber:n,setCustomZoomClicked:i,setFindNodeClicked:s,setHighlightOpsClicked:l,setPropertiesClicked:p,query:d,xml:h})=>{let r=q1(),g=(0,He.useContext)(j);if(!g)return;let v=g.themeKind,[m,P]=(0,He.useState)(!0),A;(H=>(H[H.CustomZoom=0]="CustomZoom",H[H.FindNode=1]="FindNode",H[H.HighlightOps=2]="HighlightOps",H[H.Properties=3]="Properties"))(A||={});let L=a.executionPlan.savePlan,T=a.executionPlan.openXml,U=a.executionPlan.openQuery,b=a.executionPlan.zoomIn,M=a.executionPlan.zoomOut,X=a.executionPlan.zoomToFit,O=a.executionPlan.customZoom,B=a.executionPlan.findNode,k=a.executionPlan.properties,F=a.executionPlan.highlightExpensiveOperation,Y=a.executionPlan.toggleTooltips,Z=async()=>{await g.saveExecutionPlan(h)},te=async()=>{await g.showPlanXml(h)},W=async()=>{await g.showQuery(d)},ne=async()=>{o&&(o.zoomIn(),t(o),n(o.getZoomLevel()))},J=async()=>{o&&(o.zoomOut(),t(o),n(o.getZoomLevel()))},se=async()=>{o&&(o.zoomToFit(),t(o),n(o.getZoomLevel()))},ie=async()=>{o&&(o.toggleTooltip(),t(o),P(!m))},K=z=>{z==0?(s(!1),l(!1),p(!1),i(!0)):z==1?(s(!0),l(!1),i(!1),p(!1)):z==2?(s(!1),l(!0),i(!1),p(!1)):(s(!1),l(!1),i(!1),p(!0))};return(0,x.jsxs)(Ie,{className:r.iconStack,style:{background:`${D.colorNeutralBackground2}`,minHeight:"300px"},vertical:!0,children:[(0,x.jsx)(V,{className:r.button,tabIndex:0,icon:(0,x.jsx)("img",{className:r.buttonImg,src:Ko(v),alt:L}),onClick:Z,title:L,"aria-label":L}),(0,x.jsx)(V,{className:r.button,tabIndex:0,icon:(0,x.jsx)("img",{className:r.buttonImg,src:zo(v),alt:T}),onClick:te,title:T,"aria-label":T}),(0,x.jsx)(V,{className:r.button,tabIndex:0,icon:(0,x.jsx)("img",{className:r.buttonImg,src:So(v),alt:U}),onClick:W,title:U,"aria-label":U}),(0,x.jsx)("hr",{className:r.seperator,style:{background:D.colorNeutralStroke1}}),(0,x.jsx)(V,{className:r.button,tabIndex:0,icon:(0,x.jsx)("img",{className:r.buttonImg,src:jo(v),alt:b}),onClick:ne,title:b,"aria-label":b}),(0,x.jsx)(V,{className:r.button,tabIndex:0,icon:(0,x.jsx)("img",{className:r.buttonImg,src:Qo(v),alt:M}),onClick:J,title:M,"aria-label":M}),(0,x.jsx)(V,{className:r.button,tabIndex:0,icon:(0,x.jsx)("img",{className:r.buttonImg,src:Yo(v),alt:X}),onClick:se,title:X,"aria-label":X}),(0,x.jsx)(V,{className:r.button,tabIndex:0,icon:(0,x.jsx)("img",{className:r.buttonImg,src:Zo(v),alt:O}),onClick:()=>K(0),title:O,"aria-label":O}),(0,x.jsx)("hr",{className:r.seperator,style:{background:D.colorNeutralStroke1}}),(0,x.jsx)(V,{className:r.button,tabIndex:0,icon:(0,x.jsx)("img",{className:r.buttonImg,src:Wo(v),alt:B}),onClick:()=>K(1),title:B,"aria-label":B}),(0,x.jsx)(V,{className:r.button,tabIndex:0,icon:(0,x.jsx)("img",{className:r.buttonImg,src:Jo(v),alt:k}),onClick:()=>K(3),title:k,"aria-label":k}),(0,x.jsx)(V,{className:r.button,tabIndex:0,icon:(0,x.jsx)("img",{className:r.buttonImg,src:es(v),alt:F}),onClick:()=>K(2),title:F,"aria-label":F,role:"button"}),(0,x.jsx)(V,{className:r.button,tabIndex:0,icon:(0,x.jsx)("img",{className:r.buttonImg,src:m?ts(v):ns(v),alt:Y}),onClick:ie,title:Y,"aria-label":Y,role:"button"})]})};var y=E(oe());var u=E($()),L1=_({paneContainer:{height:"100%",width:"100%",overflowX:"hidden",overflowY:"scroll"},chevronButton:{padding:0,height:"auto",minWidth:"auto",border:"none",backgroundColor:"transparent",boxShadow:"none"},button:{cursor:"pointer"},buttonImg:{display:"block",height:"16px",width:"16px"},propertiesHeader:{fontWeight:"bold",fontSize:"12px",width:"100%",padding:"4px",opacity:1,display:"flex",justifyContent:"space-between",alignItems:"center"},nameContainer:{fontWeight:"bold",fontSize:"14px",width:"100%",padding:"4px",opacity:1},tableHeader:{fontWeight:"bold",fontSize:"12px",border:"1px solid var(--vscode-foreground)"},tableRow:{height:"25px",overflow:"hidden"},tableCell:{overflow:"hidden",border:"1px solid var(--vscode-foreground)",fontSize:"12px"},inputbox:{width:"100%",minWidth:"50px",fontSize:"12px"},toolbar:{display:"flex",alignItems:"center"},dismissButton:{width:"12px",height:"12px",border:"none",outline:"none",marginRight:"4px"},textContainer:{whiteSpace:"nowrap"}}),hs=({executionPlanView:o,setPropertiesClicked:t})=>{let n=L1(),s=(0,y.useContext)(j).themeKind,[l,p]=(0,y.useState)([]),[d,h]=(0,y.useState)([]),[r,g]=(0,y.useState)(""),[v,m]=(0,y.useState)(""),[P,A]=(0,y.useState)([]),[L,T]=(0,y.useState)(!1),[U,b]=(0,y.useState)([]),[M,X]=(0,y.useState)(0),[O,B]=(0,y.useState)(""),k=a.executionPlan.properties,F=a.executionPlan.name,Y=a.executionPlan.value,Z=a.executionPlan.importance,te=a.executionPlan.alphabetical,W=a.executionPlan.reverseAlphabetical,ne=a.executionPlan.expandAll,J=a.executionPlan.collapseAll,se=a.executionPlan.filterAnyField;(0,y.useEffect)(()=>{if(!P.length&&!L){let c=o.getSelectedElement(),I=c&&"name"in c?c:o.getRoot();ie(I)}},[P,L]),(0,y.useEffect)(()=>{let c=setInterval(()=>{let I=o.getSelectedElement(),C=I&&"name"in I?I:o.getRoot();C.id!==v&&ie(C)},1e3);return()=>clearInterval(c)});function ie(c){g(c.name),m(c.id);let I=vs(c.properties,0,0,!1,-1);A(Te(I,I.filter(C=>!C.isChild),2)),X(I.length)}let K=async(c,I)=>{l.includes(I[0])?(p(C=>C.filter(ee=>!I.includes(ee))),h(d.filter(C=>C!==c))):(p(C=>[...C,...I]),h([...d,c]))},z=async c=>{let I=H();A(Te(I,I.filter(C=>!C.isChild),c))},S=async()=>{let c=H();h(c.map(I=>I.name)),p(c.map(I=>I.id))},de=async()=>{H(),h([]),p([])},ae=async c=>{let I=!1;if(P.length===M&&(b(P),I=!0),c!==""){let C=I?P:U,ee=C.filter(ue=>ue.name.includes(c)||ue.value.includes(c));A(gs(ee,C)),T(!0)}else H()};function H(){let c=L?U:P;return A(U),T(!1),B(""),c}let le=[Ce({columnId:"name",renderHeaderCell:()=>F,renderCell:c=>(0,u.jsxs)(Ee,{truncate:!0,className:n.textContainer,children:["\u200B	".repeat(c.level*6),c.children.length>0&&(0,u.jsx)(R,{size:"small",className:n.chevronButton,"aria-label":d.includes(c.name)?a.executionPlan.collapse:a.executionPlan.expand,icon:d.includes(c.name)?(0,u.jsx)(Ue,{}):(0,u.jsx)($e,{}),onClick:()=>K(c.name,c.children)}),c.name]})}),Ce({columnId:"value",renderHeaderCell:()=>Y,renderCell:c=>(0,u.jsx)(Ee,{truncate:!0,className:n.textContainer,children:c.value})})];return(0,u.jsxs)("div",{id:"propertiesPanelContainer",className:n.paneContainer,style:{background:D.colorNeutralBackground2,borderLeft:`0.5px solid ${D.colorNeutralStroke1}`},children:[(0,u.jsxs)("div",{style:{position:"sticky",top:0,zIndex:1,background:D.colorNeutralBackground1},children:[(0,u.jsxs)("div",{className:n.propertiesHeader,style:{background:D.colorNeutralBackground2},children:[(0,u.jsx)("div",{"aria-label":k,tabIndex:0,children:k}),(0,u.jsx)("div",{tabIndex:0,children:(0,u.jsx)(R,{className:n.dismissButton,style:{background:D.colorNeutralBackground2},onClick:()=>t(!1),title:a.common.close,"aria-label":a.common.close,icon:(0,u.jsx)(Re,{})})})]}),(0,u.jsx)("div",{className:n.nameContainer,"aria-label":r,tabIndex:0,children:r}),(0,u.jsxs)(Ie,{className:n.toolbar,size:"small",children:[(0,u.jsx)(V,{className:n.button,tabIndex:0,icon:(0,u.jsx)("img",{className:n.buttonImg,src:os(s),alt:Z}),onClick:()=>z(2),title:Z,"aria-label":Z}),(0,u.jsx)(V,{className:n.button,tabIndex:0,icon:(0,u.jsx)("img",{className:n.buttonImg,src:ss(s),alt:te}),onClick:()=>z(0),title:te,"aria-label":te}),(0,u.jsx)(V,{className:n.button,tabIndex:0,icon:(0,u.jsx)("img",{className:n.buttonImg,src:is(s),alt:W}),onClick:()=>z(1),title:W,"aria-label":W}),(0,u.jsx)(V,{className:n.button,tabIndex:0,icon:(0,u.jsx)("img",{className:n.buttonImg,src:ls(s),alt:ne}),onClick:S,title:ne,"aria-label":ne}),(0,u.jsx)(V,{className:n.button,tabIndex:0,icon:(0,u.jsx)("img",{className:n.buttonImg,src:rs(s),alt:J}),onClick:de,title:J,"aria-label":J}),(0,u.jsx)(ce,{type:"text",size:"small",className:n.inputbox,value:O,placeholder:se,contentBefore:(0,u.jsx)("img",{src:as(s),alt:se,style:{width:"20px",height:"20px"}}),onChange:c=>{B(c.target.value),ae(c.target.value)}})]})]}),(0,u.jsx)("div",{style:{width:"100%"},children:(0,u.jsxs)(ke,{items:P,columns:le,focusMode:"composite",resizableColumns:!0,size:"small",children:[(0,u.jsx)(Fe,{className:n.tableHeader,style:{background:D.colorNeutralBackground2},children:(0,u.jsx)(Pe,{className:n.tableRow,children:({renderHeaderCell:c})=>(0,u.jsx)(Ke,{className:n.tableHeader,children:c()})})}),(0,u.jsx)(Oe,{tabIndex:0,children:({item:c,rowId:I})=>(0,u.jsx)(u.Fragment,{children:(!c.isChild||l.includes(c.id))&&(0,u.jsx)(Pe,{className:n.tableRow,children:({renderCell:C})=>(0,u.jsx)(Xe,{className:n.tableCell,children:C(c)})},I)})})]})})]})};function vs(o,t,n,i,s){let l=[];for(let p of o){let d=[],h=[];typeof p.value!="string"&&(h=vs(p.value,t+1,n+1,!0,t),d=h.map((g,v)=>{let m=t+1+v;return g.id=m,{id:m,level:g.level}}).filter(g=>g.level===n+1).map(g=>g.id));let r={id:t,name:p.name,value:p.displayValue,parent:s,children:d,displayOrder:p.displayOrder,isExpanded:!1,isChild:i,level:n};l.push(r),l=l.concat(h),t+=h.length+1}return l}function gs(o,t){let n=[];for(let i of o){if(i.parent!=-1){let s=t.find(l=>i.parent===l.id);if(s&&!n.some(l=>l.id===s.id)){let l=gs([s],t).filter(p=>!n.some(d=>d.id===p.id));n=n.concat(l)}}n.push(i)}return n}function Te(o,t,n){let i=[];n==0?t=t.sort((s,l)=>s.name.localeCompare(l.name)):n==1?t=t.sort((s,l)=>l.name.localeCompare(s.name)):n==2&&(t=t.sort((s,l)=>s.displayOrder-l.displayOrder));for(let s of t){i.push(s);let l=[];for(let p of s.children){let d=o.find(h=>h.id===p);d&&l.push(d)}i=i.concat(Te(o,l,n))}return i}var f=E($()),T1=_({panelContainer:{display:"flex",flexDirection:"row",width:"100%",height:"100%",position:"relative",overflowY:"hidden"},planContainer:{display:"flex",flexDirection:"column",flexGrow:1,width:"100%",minHeight:"300px"},inputContainer:{position:"absolute",top:0,right:"35px",padding:"10px",border:"1px solid #ccc",zIndex:"1",boxShadow:"0px 4px 6px rgba(0, 0, 0, 0.1)",display:"flex",alignItems:"center",gap:"2px",opacity:1},queryCostContainer:{opacity:1,padding:"5px"},queryPlanParent:{opacity:1,height:"100%",width:"100%",overflowX:"auto"},resizable:{position:"absolute",top:0,right:"35px",opacity:1,boxSizing:"border-box",minWidth:"295px",height:"100%",maxWidth:"100%",maxHeight:"100%"},resizer:{position:"absolute",left:0,height:"100%",width:"15px",cursor:"ew-resize",backgroundColor:"transparent"},spacer:{padding:"1px"}}),ms=({graphIndex:o})=>{let t=T1(),n=(0,w.useContext)(j),i=n?.state.executionPlanState,[s,l]=(0,w.useState)(!1),[p,d]=(0,w.useState)(""),[h,r]=(0,w.useState)(""),[g,v]=(0,w.useState)(0),[m,P]=(0,w.useState)(null),[A,L]=(0,w.useState)(100),[T,U]=(0,w.useState)(!1),[b,M]=(0,w.useState)(!1),[X,O]=(0,w.useState)([]),[B,k]=(0,w.useState)(!1),[F,Y]=(0,w.useState)(!1),[Z,te]=(0,w.useState)(400),[W,ne]=(0,w.useState)("100%"),J=(0,w.useRef)(null);(0,w.useEffect)(()=>{if(!i||s)return;ne(i.executionPlanGraphs.length>1&&o!==i.executionPlanGraphs.length-1?"500px":"100%"),window.mxLoadResources=!1,window.mxForceIncludes=!1,window.mxResourceExtension=".txt",window.mxLoadStylesheets=!1,window.mxBasePath="./src/reactviews/pages/ExecutionPlan/mxgraph";let S=je();function de(){if(i&&i.executionPlanGraphs){let ae=i.executionPlanGraphs[o].root,H=new fe(ae),le=H.populate(ae),I={container:document.getElementById(`queryPlanParent${o+1}`),queryPlanGraph:le,iconPaths:Oo(),badgeIconPaths:ko(),expandCollapsePaths:Fo(n.themeKind),showTooltipOnClick:!0},C=new S.azdataQueryPlan(I);C.setTextFontColor("var(--vscode-editor-foreground)"),C.setEdgeColor("var(--vscode-editor-foreground)"),H.setDiagram(C),P(H),l(!0),O(H.getUniqueElementProperties());let ee=i.executionPlanGraphs[o].query;if(o!=0){let ue=ee.search(/[a-zA-Z]/);ue!==-1&&(ee=ee.slice(ue))}d(ee),r(i.executionPlanGraphs[o].graphFile.graphFileContent),v(H.getTotalRelativeCost())}else return}de()},[i]);let se=async()=>{m&&(m.setZoomLevel(A),P(m),L(m.getZoomLevel())),U(!1)},ie=()=>(g/i.totalCost*100).toFixed(2),K=()=>a.executionPlan.queryCostRelativeToScript(o+1,ie()),z=S=>{S.preventDefault();let de=S.pageX,ae=J.current.offsetWidth,H=c=>{let I=ae-(c.pageX-de);te(I)},le=()=>{document.removeEventListener("mousemove",H),document.removeEventListener("mouseup",le)};document.addEventListener("mousemove",H),document.addEventListener("mouseup",le)};return(0,f.jsxs)("div",{id:"panelContainer",className:t.panelContainer,style:{height:W,fontFamily:D.fontFamilyBase},children:[(0,f.jsxs)("div",{id:"planContainer",className:t.planContainer,style:{height:W},children:[(0,f.jsxs)("div",{id:"queryCostContainer",className:t.queryCostContainer,style:{background:D.colorNeutralBackground2},"aria-live":"polite","aria-label":`${K()}, ${p}`,children:[K(),(0,f.jsx)("br",{}),p]}),(0,f.jsx)("div",{id:`queryPlanParent${o+1}`,className:t.queryPlanParent,style:{width:F?`calc(100% - ${Z}px - 35px)`:"calc(100% - 35px)"}}),(0,f.jsx)(he,{open:T,children:(0,f.jsxs)("div",{id:"customZoomInputContainer",className:t.inputContainer,style:{background:D.colorNeutralBackground1},tabIndex:0,children:[(0,f.jsx)(ce,{id:"customZoomInputBox",type:"number",size:"small",min:1,tabIndex:0,title:a.executionPlan.customZoom,"aria-label":a.executionPlan.customZoom,defaultValue:Math.floor(A).toString(),input:{style:{width:"85px",textOverflow:"ellipsis"}},onChange:S=>L(Number(S.target.value)),style:{width:"100px",height:"25px",fontSize:"12px"}}),(0,f.jsx)("div",{className:t.spacer}),(0,f.jsx)(R,{onClick:se,size:"small",appearance:"subtle",title:a.common.apply,"aria-label":a.common.apply,icon:(0,f.jsx)(ge,{})}),(0,f.jsx)(R,{icon:(0,f.jsx)(re,{}),size:"small",appearance:"subtle",title:a.common.close,"aria-label":a.common.close,onClick:()=>U(!1)})]})}),(0,f.jsx)(he,{open:b,children:(0,f.jsx)("div",{tabIndex:0,children:(0,f.jsx)(cs,{executionPlanView:m,setExecutionPlanView:P,findNodeOptions:X,setFindNodeClicked:M})})}),(0,f.jsx)(he,{open:B,children:(0,f.jsx)("div",{tabIndex:0,children:(0,f.jsx)(ds,{executionPlanView:m,setExecutionPlanView:P,setHighlightOpsClicked:k})})}),F&&(0,f.jsxs)("div",{className:t.resizable,style:{width:`${Z}px`},ref:J,children:[(0,f.jsx)("div",{className:t.resizer,onMouseDown:z}),(0,f.jsx)(he,{open:F,children:(0,f.jsx)("div",{children:(0,f.jsx)(hs,{executionPlanView:m,setPropertiesClicked:Y})})})]})]}),(0,f.jsx)(us,{executionPlanView:m,setExecutionPlanView:P,setZoomNumber:L,setCustomZoomClicked:U,setFindNodeClicked:M,setHighlightOpsClicked:k,setPropertiesClicked:Y,query:p,xml:h})]})};var Q=E($()),M1=_({outerDiv:{height:"100%",width:"100%",position:"relative",overflowY:"auto",overflowX:"unset"},spinnerDiv:{height:"100%",width:"100%",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",padding:"20px"},errorIcon:{fontSize:"100px",opacity:.5}}),Dd=()=>{let o=M1(),t=(0,be.useContext)(j),n=t?.state?.executionPlanState,i=n?.loadState??"loading";(0,be.useEffect)(()=>{t&&n&&n.executionPlanGraphs&&!n.executionPlanGraphs.length&&t.getExecutionPlan()},[n]);let s=()=>{switch(i){case"loading":return(0,Q.jsx)("div",{className:o.spinnerDiv,children:(0,Q.jsx)(Ge,{label:"Loading execution plan...",labelPosition:"below"})});case"loaded":return(n?.executionPlanGraphs??[])?.map((p,d)=>(0,Q.jsx)(ms,{graphIndex:d},d));case"error":return(0,Q.jsxs)("div",{className:o.spinnerDiv,children:[(0,Q.jsx)(Me,{className:o.errorIcon}),(0,Q.jsx)(Be,{size:400,children:n?.errorMessage??""})]})}};return(0,Q.jsx)("div",{className:o.outerDiv,children:s()})};export{R1 as a,Dd as b};
